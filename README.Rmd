---
output:
  md_document:
    variant: markdown_github
editor_options:
  chunk_output_type: console
---


```{r echo=FALSE}
knitr::opts_chunk$set(
  comment = "#>",
  collapse = TRUE,
  warning = FALSE,
  message = TRUE
)
```

[![Project Status: Concept â€“ Minimal or no implementation has been done yet, or the repository is only intended to be a limited example, demo, or proof-of-concept.](http://www.repostatus.org/badges/latest/concept.svg)](http://www.repostatus.org/#concept)
[![Travis-CI Build Status](https://travis-ci.org/patperu/effisr.svg?branch=master)](https://travis-ci.org/patperu/effisr)


# effisr

## Current

```{r}

library(effisr)
library(sf)

res <- ef_current(country = "IT", limit = 250, ordering = "-firedate")
res$docs <- sf::st_as_sf(res$docs, crs = 4326)

dplyr::glimpse(res$docs)

plot(res$docs$geo_shape)

```

```{r}

library(ggplot2)

x <- res$docs

gg <- ggplot(x) +
      geom_sf(aes(color = area_ha,
                  size = area_ha, 
                  geometry = geo_shape)) +
      ggtitle("Fire") +
      theme(legend.position="bottom") 
gg

```

## Leaflet

```{r}

library(leaflet)
library(leaflet.extras)

leaflet(dplyr::filter(x, province == "Palermo")) %>%
   addTiles() %>%
   addPolygons(label = ~area_ha, popup = ~area_ha)

```

## Trend

```{r}

x <- ef_trend(country = c("IT", "FR", "ES"), decimate = 7)
dplyr::glimpse(x)

gg <- ggplot(x, aes(day, current_ba, group = country, color = country)) + geom_line()
gg <- gg + scale_x_date(expand=c(0,1), limits=range(x$day))
gg <- gg + labs(x=NULL,
                title="Burnt Areas 2017",
                subtitle="",
                caption="Source: EFFIS")
gg <- gg + theme_bw()
gg

```

## Fires

```{r}

x <- ef_fires(country_iso2 =  c("IT", "ES"), limit = 10)
dplyr::glimpse(x)

```

## Cumulative

```{r cumulative}

IT_cum <- ef_hcu(2006:2016, "IT")
gg <- ggplot(IT_cum, aes(date, trend_ba, group = year, colour = factor(year))) + geom_line()
gg <- gg + labs(x=NULL,
                title="Cumulative Burnt Areas by year (Italy)",
                color = "Year",
                subtitle="",
                caption="Source: EFFIS")
gg <- gg + theme_bw()
gg

FR_cum <- ef_hcu(2006:2016, "FR")
gg <- ggplot(FR_cum, aes(date, trend_nf)) + geom_line(aes(group = year, colour = factor(year)))
gg <- gg + labs(x=NULL,
                title="Cumulative Number of fires by year (France)",
                color = "Year",
                subtitle="",
                caption="Source: EFFIS")
gg <- gg + theme_bw()
gg
```

Please note that this project is released with a [Contributor Code of Conduct](CONDUCT.md). By participating in this project you agree to abide by its terms.
